<form class="modal-content" [formGroup]="productForm">
    <div class="modal-header">
        <div class="image-container">
          <img [src]="productImgUrl" alt="Imagen del producto" class="product-image" *ngIf="productImgUrl">
          <button class="edit-button" (click)="editImage()">
            ✎
          </button>
          
        </div>
        <button (click)="close()" class="close-button">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-x-lg" viewBox="0 0 16 16">
            <path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8z"/>
          </svg>
        </button>
      </div>

    <hr class="divider">
    <fieldset class="form-group">
      <header>
        <label for="name">Nombre del producto</label>
      </header>
      <div class="inputs-container">
        <div class="input-container">
          <input id="name" type="text" formControlName="name" placeholder="Ej. Pizza" class="form-control" />
          <div *ngIf="productForm.controls['name'].hasError('required') && productForm.controls['name'].touched" class="error">
            El nombre es obligatorio
          </div>
        </div>
      </div>
    </fieldset>

    <hr class="divider">
    <fieldset class="form-group">
      <header>
        <label for="price">Tarifas <span class="input-mandatory">*</span></label>
        <span class="text-info">Puedes insertar diferentes tarifas para modificarla con un click en un futuro.</span>
        <div *ngIf="productForm.controls['price_1'].hasError('required') && productForm.controls['price_1'].touched" class="error">
          La tarifa 1 es obligatoria
        </div>
        <div *ngIf="productForm.controls['price_1'].hasError('pattern') && productForm.controls['price_1'].touched" class="error">
          La tarifa 1 debe ser un número válido
        </div>
        <div *ngIf="productForm.controls['price_2'].hasError('pattern') && productForm.controls['price_2'].touched" class="error">
          El tarfia 2 debe ser un número válido
        </div>
        <div *ngIf="productForm.controls['price_3'].hasError('pattern') && productForm.controls['price_3'].touched" class="error">
          El tarifa 3 debe ser un número válido
        </div>
      </header>
      <div class="inputs-container">
        <div class="input-container">
          <input id="price" type="text" formControlName="price_1" placeholder="Ej. 10.00" class="form-control" />
        </div>
        <div class="input-container">
          <input type="text" formControlName="price_2" placeholder="Ej. 12.00" class="form-control" />
        </div>
        <div class="input-container">
          <input type="text" formControlName="price_3" placeholder="Ej. 14.00" class="form-control" />
        </div>
        
      </div>
    </fieldset>

    <hr class="divider">
    <fieldset class="form-group">
      <header>
        <label for="family">Familia y estado<span class="input-mandatory">*</span></label>
      </header>
      <div class="inputs-container">
        <div class="input-container">
          <select name="family" formControlName="family" id="family" placeholder="Escoja una familia" class="form-control select">
            <option value="" class="option-disabled" disabled selected>Seleccione familia</option>
            @for(family of families; track $index){
              <option [value]="family.id">{{ family.name }}</option>
            }
          </select>
        </div>
        <span (click)="changeStatus()" [ngStyle]="getStatusStyle(data.status!)" class="status-text">
          <!-- SVG Icono dinámico según el estado -->
          <ng-container *ngIf="data.status === 'Habilitado'">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="green" class="bi bi-check-circle-fill status-icon" viewBox="0 0 16 16">
              <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM6.904 10.803L4.3 8.2a.717.717 0 1 0-1.014 1.014l2.969 2.97a.717.717 0 0 0 1.014 0l6.18-6.18a.717.717 0 1 0-1.014-1.014L6.904 10.803z"/>
            </svg>
          </ng-container>
          <ng-container *ngIf="data.status === 'Deshabilitado'">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="red" class="bi bi-x-circle-fill status-icon" viewBox="0 0 16 16">
              <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
            </svg>
          </ng-container>
          {{ data.status }}
        </span>
        
      </div>
    </fieldset>
  
  <div class="dialog-actions">
    <button class="delete-button" *ngIf="data.productId" (click)="onDelete(data.productId)">Eliminar</button>
    <button (click)="close()">Cancelar</button>
    <button [disabled]="productForm.invalid" (click)="save()">
      {{ isEditMode ? 'Guardar Cambios' : 'Añadir' }}
    </button>
  </div>
</form>